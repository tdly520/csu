<html>

<head><!-- --------THIS CALLS THE CASCADING STYLE SHEET---------------- -->

<link rel="stylesheet" link="text/css" href="sqlHTML.css">
<!-- --------THIS CALLS THE CASCADING STYLE SHEET---------------------- -->


<title>Server page</title>
</head>
<script id="sqlMenu"  src="sqlMenu.js"></script>


<body bgcolor="window">

<!-- BEGIN SERVER INFO--------------------------------------------->

<table class="titleTable" cellspacing="0" cellpadding="0" border="0">
  <tr >
   <td width="32"  valign="bottom"><img src="MenuTop.gif" border="0" ID="imgMenuTitle1" class="clsMenuTitle"></img></td>
   <td width=1%></td>
   <td width=99% align="left"><font class="TitleFont" id="szServerText"><!--Server--></font></td>
  </tr>
  <tr>
    <td width="32" height="1"><img src="MenuMiddle.gif" border="0" ID="imgMenuTitle1" class="clsMenuTitle"></img></td>
    <td class="ColorRow1" colspan="2"></td>
    <td width=1%></td>
  </tr>
  <tr>
   <td width="32"><img src="MenuBottom.gif" border="0" ID="imgMenuTitle1" class="clsMenuTitle"></img></td>
   <td width=1%></td>
   <td width=100% align="left"></td>
  </tr>
</table>

<table class="RowTbl">

  <tr id="trServerName">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szServerNameText"><!--Server Name:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="serverName"></font></td>
  </tr>
  <tr id="trEdition">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szEditionText"><!--Edition:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szEdition"></font></td>
  </tr>
  <tr id="trVersion">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szVersionText"><!--Version:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szVersion"></font></td>
  </tr>
  <tr id="trRAM">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szRAMText"><!--RAM:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="idRAM"></font></td>
  </tr>
  <tr id="trProc">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szProcessorsText"><!--Processors:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="idProc"></font></td>
  </tr>
  <tr id="trDiskSpaceUsed">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%" ><font class="LabelFont" id="szDiskSpaceText"><!--Disk space used on (drive letter):--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="spaceUsed"><!--!!--></font></td>
  </tr>
    <tr id="trOS">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szOSText"><!--Operating System:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szOS"></font></td>
  </tr>
</table>
<br>
<br>
<br>
<!-- END SERVER INFO--------------------------------------------->


<!-- BEGIN CONFIGURATION INFO--------------------------------------------->

<table class="titleTable" cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td width="32"  valign="bottom"><img src="MenuTop.gif" border="0" ID="imgMenuTitle2" class="clsMenuTitle"></img></td>
   <td width=1%></td>
   <td width=99% align="left"><font class="TitleFont" id="szConfText"><!--Configuration--></font></td>
  </tr>
  <tr>
    <td width="32" height="1"><img src="MenuMiddle.gif" border="0" ID="imgMenuTitle2" class="clsMenuTitle"></img></td>
    <td class="ColorRow1" colspan="2"></td>
    <td width=1%></td>
  </tr>
  <tr>
   <td width="32"><img src="MenuBottom.gif" border="0" ID="imgMenuTitle2" class="clsMenuTitle"></img></td>
   <td width=1%></td>
   <td width=100% align="left"></td>
  </tr>
  
</table>

<table class="RowTbl">
  <tr id="trMSX">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szMSXText"><!--Master Server:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szMSX"></font></td>
  </tr>

    <tr id="trTSX">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szTSXText"><!--Target Server:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szTSX"></font></td>
  </tr>
  
    <tr id="trPublisher">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szPublisherText"><!--Publisher:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szPublisher"></font></td>
  </tr>

    <tr id="trSubscriberPull">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%" ><font class="LabelFont" id="szSubscriberTextPull"><!--Subscriber:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szSubscriberPull"></font></td>
  </tr>

    <tr id="trSubscriberPush">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szSubscriberTextPush"><!--Subscriber:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id="szSubscriberPush"></font></td>
  </tr>
  
  <tr id="trDistributor">
    <td class="WhiteRow" td WIDTH="32"></td>
    <td class="WhiteRow" td WIDTH="1%"></td>
    <td class="WhiteRow" td WIDTH="45%"><font class="LabelFont" id="szDistributorText"><!--Distributor:--></font></td>
    <td class="WhiteRow" WIDTH="50%"><font class="DataFont" id ="szDistributor"></font></td>
  </tr>
  
</table>

<br>
<br>
<br>
<!-- END CONFIGURATION INFO--------------------------------------------->

<table class="clsMenu" id="divMenu1"> 
    <tr>
        <td id="td_Menu"><font class="DataFont"><span id="divMenu1_1" class="clsMenuSpanNonSel" onmouseout="MouseOut()" onmouseover="MouseOver()" ><!--Register a Server--></span></font></td>
    </tr>
    <tr>
        <td id="td_Menu"><font class="DataFont"><span id="divMenu1_2" class="clsMenuSpanNonSel" onmouseout="MouseOut()" onmouseover="MouseOver()" ><!--Edit Registered Properties--></span></font></td>
    </tr>
    <tr>
        <td id="td_Menu"><font class="DataFont"><span id="divMenu1_3" class="clsMenuSpanNonSel" onmouseout="MouseOut()" onmouseover="MouseOver()" ><!--Properties--></span></font></td>
    </tr>
</table>    

<table class="clsMenu" id="divMenu2"> 
    <tr>
        <td id="td_Menu"><font class="DataFont"><span id="divMenu2_1" class="clsMenuSpanNonSel" onmouseout="MouseOut()" onmouseover="MouseOver()" ><!--Make a Master Server--></span></font></td>
    </tr>
    <tr>
        <td id="td_Menu"><font class="DataFont"><span id="divMenu2_2" class="clsMenuSpanNonSel" onmouseout="MouseOut()" onmouseover="MouseOver()" ><!--Make a Target Server--></span></font></td>
    </tr>
    <tr>
        <td id="td_Menu"><font class="DataFont"><span id="divMenu2_3" class="clsMenuSpanNonSel" onmouseout="MouseOut()" onmouseover="MouseOver()" ><!--Configure Publishing and Distribution--> </span></font></td>
    </tr>
</table>    


<script language="JScript" for="document" event="onmouseover()">

   DoMenu(2);

</script>


<script language="JScript">

function isPublisher(objDatabase)
{
    try
    {
        if( "object" == typeof(objDatabase.Replication.Distributor.DistributionPublishers(objDatabase.TrueName)))
        {
            return true;
        }
        else
        {
            return false;
        }
    }
    catch(e)
    {
    }    
}

</script>


<script language="JScript">

function LoadPageGen()
{

    var     editionQuery;
    var     spaceMB;
    var     count;
    var     countPush;
    var     i;
    var     bStatus;
    
    bStatus = true;
    
    try
    {
        if(parent.window.frames(0).hdnIsLoaded.value == 0)
        {
            return;
        }        
        else
        {
            window.clearInterval(timerID)        
        }
    }
    catch(e)
    {
        bStatus = false;
    }
    
    if(!bStatus)
    {
        return;
    }
    
    parent.window.frames(0).clickGeneralTab()
    strContextCookie    = parent.window.frames(0).GetParameterX("SQLNSCookie")
        
    try
    {
        objDatabase     = parent.window.objSQLNSContext.GetDMOObject(strContextCookie);
        
        if(!objDatabase.VerifyConnection(2))
        {
            return;
        }
    }
    catch(e)
    {
        return;
    }
    
    try
    {
        if(!objDatabase.Issysadmin)
        {
            divMenu1_3.style.display  = "none"
            divMenu2.style.display    = "none"
        }            
    }
    catch(e)
    {
    }
    
    try
    {
        serverName.innerText                                    = objDatabase.TrueName 

        parent.window.frames(0).document.all.svrName1.innerText = objDatabase.TrueName
        parent.window.frames(0).document.all.svrName2.innerText = objDatabase.TrueName
           
    }
    catch(e)
    {
        trServerName.style.display                              = "none"
    }
    
    try
    {
        idRAM.innerText                                         = objDatabase.Registry.PhysicalMemory  + " " + parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4035)        
    }
    catch(e)
    {
        trRAM.style.display                                     = "none"
    }
    
    try
    {
        idProc.innerText                                        = objDatabase.Registry.NumberOfProcessors
    }
    catch(e)
    {
        trProc.style.display                                    = "none"
    }

    try
    {    
        szVersion.innerText                                     = "Microsoft SQL Server  " + objDatabase.VersionMajor + "." + objDatabase.VersionMinor
    }
    catch(e)
    {
        trVersion.style.display                                 = "none"
    }        

    editionQuery = "select 'Server SKU'=SUBSTRING(@@version,PATINDEX(N'%Corporation%',@@version)+DATALENGTH('Corporation')+2,PATINDEX(N'% on %',@@version)-(PATINDEX(N'%Corporation%',@@version)+DATALENGTH('Corporation')+2))"    
    
    try
    {
        szEdition.innerText = objDatabase.ExecuteWithResults(editionQuery).GetColumnString(1, 1)
    }
    catch(e)
    {
        trEdition.style.display = "none"
    }
    
    spaceMB = 0
    
    try
    {
        objDatabase.Databases.Refresh
    }
    catch(e)
    {
    }        
    for(i = 1; i <= objDatabase.Databases.Count; i++)
    {
        try
        {            
            spaceMB = spaceMB +  objDatabase.Databases.Item(i).Size
        }
        catch(e)
        {
        }            
    }
    
    spaceUsed.innerText = spaceMB + " " + parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4035)
    
    try
    {
        if(objDatabase.Replication.Distributor.DistributorInstalled)
        {
            if(objDatabase.Replication.Distributor.DistributorLocal)
            {
                szDistributor.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
                if(isPublisher(objDatabase))
                {
                    szPublisher.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)       
                }
                else
                {
                    szPublisher.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)               
                }
            }                            
            else    
            {
                szPublisher.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
                szDistributor.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
            } 
        }                               
        else
        {
            szDistributor.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
            szPublisher.innerText   = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
        }
    }
    catch(e)
    {
        trDistributor.style.display = "none"
        trPublisher.style.display   = "none"
    }   
    
    count       = 0
    countPush   = 0
    
    try
    {
        objDatabase.Replication.ReplicationDatabases.Refresh()
        objDatabase.Databases.Refresh()

        for(i = 1; i<= objDatabase.Replication.ReplicationDatabases.Count; i++)
        {
            count = count + objDatabase.Replication.ReplicationDatabases(i).MergePullSubscriptions.Count + objDatabase.Replication.ReplicationDatabases(i).TransPullSubscriptions.Count
        }        
    }
    catch(e)
    {
    }  

    try
    {    
        if( (objDatabase.VersionMajor == 7 && objDatabase.VersionMinor >= 50 ) || objDatabase.VersionMajor >= 8)
        {                            
	        countPush = objDatabase.Replication.Subscriber.EnumAllSubscriptions().Rows                                        
        }	        
    }
    catch(e)
    {
        countPush                       = 0;
        trSubscriberPush.style.display  = "none";
    }	    

    if(count > 0)
    {
        szSubscriberPull.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
    }
    else
    {
        szSubscriberPull.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
    } 

    if( countPush > 0 )
    {
        szSubscriberPush.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
    }
    else        
    {
        szSubscriberPush.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
    }
    
    try
    {   
        if(objDatabase.isOS(1))
        {
            szOS.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4147)
        }
        else
        {
            szOS.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4146) 
        }            
    }
    catch(e)
    {
        trOS.style.display = "none"
    }
    
    try
    {
        if(objDatabase.JobServer.type == 3)
        {
            szMSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
        }
        else
        {
            szMSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
        }

        if(objDatabase.JobServer.type == 2)
        {
            szTSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
        }
        else
        {
            szTSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
        }                
    }
    catch(e)
    {
        trTSX.style.display = "none"
        trMSX.style.display = "none"
    }
}

</script>

<script language="JScript" for="document" event="onclick()">

    var     el;

    el = window.event.srcElement;
                  
    switch(el.id)
    {
        // first group
        case 'divMenu1_1':
        {
            divMenu1.style.visibility="hidden";
            parent.window.objSQLNSContext.InvokeCommand(strContextCookie, 2000)
            break;
        }
        case 'divMenu1_2':
        {
            divMenu1.style.visibility="hidden";
            parent.window.objSQLNSContext.InvokeCommand( strContextCookie, 1801); 
            break;
        }
        case 'divMenu1_3':
        {
            divMenu1.style.visibility="hidden";
            parent.window.objSQLNSContext.InvokeCommand(strContextCookie, 3012)
            break;
        }
        case 'divMenu2_1':
        {
            divMenu2.style.visibility="hidden";
            parent.window.objSQLNSContext.InvokeCommand(strContextCookie, 740)
            break;
        }
        case 'divMenu2_2':
        {
            divMenu2.style.visibility="hidden";
            parent.window.objSQLNSContext.InvokeCommand(strContextCookie, 745)
            break;
        }
        case 'divMenu2_3':
        {
            divMenu2.style.visibility="hidden";
            parent.window.objSQLNSContext.InvokeCommand(strContextCookie,  2314)
            break;
        }        
    }
</script>      

<script language="jscript" event="onmouseout()" for="document">

var         ev;

ev = window.event;

try
{
    if(ev.toElement.tagName == "html")
    {
        divMenu1.style.visibility = "hidden"
    }
}
catch(e)
{
    divMenu1.style.visibility = "hidden"
    divMenu2.style.visibility = "hidden"
}

</script>

<script language="jscript" for="document" event="onselectstart()">

    window.event.returnValue = false;

</script>

<script language="JScript">

var         objDatabase
var         strContextCookie
var         t
var         spaceMB
var         timerID
var         count
var         countPush
var         editionQuery


szServerText.innerText          = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4117)
szServerNameText.innerText      = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4118)          
szEditionText.innerText         = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4119)     
szVersionText.innerText         = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4120)     
szRAMText.innerText             = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4121)
szProcessorsText.innerText      = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4122)          
szDiskSpaceText.innerText       = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4123)     
szOSText.innerText              = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4124)     
szConfText.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4125)
szMSXText.innerText             = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4126)
szTSXText.innerText             = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4127)
szPublisherText.innerText       = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4128)
szSubscriberTextPull.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4129)
szSubscriberTextPush.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4148)
szDistributorText.innerText     = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4138)                                                                                                                                                                

divMenu1_1.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4133)
divMenu1_2.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4134)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

divMenu1_3.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4135)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

divMenu2_1.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4130)
divMenu2_2.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4131)
divMenu2_3.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4132)    


timerID = window.setInterval("LoadPageGen()", 50)    

/*
Sub LoadPageGenX

If parent.window.frames(0).hdnIsLoaded.value = 0 Then
    Exit Sub
Else
    window.clearInterval(timerID)        
End If


parent.window.frames(0).clickGeneralTab()
strContextCookie    = parent.window.frames(0).GetParameterX("SQLNSCookie")
Set objDatabase     = parent.window.objSQLNSContext.GetDMOObject(strContextCookie)

If Not objDatabase.VerifyConnection(2) Then
    Exit Sub
End If

If Not objDatabase.Issysadmin Then
    divMenu1_3.style.display = "none"
    divMenu2.style.display    = "none"
    
    ' hide also some fields that cannot be retrieved unless the user is a sysadmin
    trDiskSpaceUsed.style.display       = "none"
    trSubscriberPush.style.display      = "none"
    trSubscriberPull.style.display      = "none"
        
Else
    divMenu1_3.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4135)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

    divMenu2_1.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4130)
    divMenu2_2.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4131)
    divMenu2_3.innerText            = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4132)    
    
End If 

serverName.innerText                                    = objDatabase.TrueName
parent.window.frames(0).document.all.svrName1.innerText = objDatabase.TrueName
parent.window.frames(0).document.all.svrName2.innerText = objDatabase.TrueName
idRAM.innerText                                         = objDatabase.Registry.PhysicalMemory  & " " & parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4035)
idProc.innerText                                        = objDatabase.Registry.NumberOfProcessors
szVersion.innerText                                     = "Microsoft SQL Server  " & objDatabase.VersionMajor & "." & objDatabase.VersionMinor

editionQuery = "select 'Server SKU'=SUBSTRING(@@version,PATINDEX(N'%Corporation%',@@version)+DATALENGTH('Corporation')+2,PATINDEX(N'% on %',@@version)-(PATINDEX(N'%Corporation%',@@version)+DATALENGTH('Corporation')+2))"
szEdition.innerText = objDatabase.ExecuteWithResults(editionQuery).GetColumnString(1, 1)

spaceMB = 0

For i = 1 To objDatabase.Databases.Count
    objDatabase.Databases.Refresh
    If VerifyDatabaseStatus(objDatabase.Databases.Item(i)) Then
        If objDatabase.Issysadmin Then
            spaceMB = spaceMB +  objDatabase.Databases.Item(i).Size
        End If            
    End If         
Next


spaceUsed.innerText = spaceMB & " " & parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4035)

If objDatabase.Replication.Distributor.DistributorInstalled = True Then
    If objDatabase.Replication.Distributor.DistributorLocal = True Then
        szDistributor.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
        If isPublisher(objDatabase) Then
            szPublisher.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)       
        Else
            szPublisher.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)               
        End If
    Else    
        szPublisher.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
    End If
Else
    szDistributor.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
    szPublisher.innerText   = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
End If

count       = 0
countPush   = 0
objDatabase.Replication.ReplicationDatabases.Refresh
For i = 1 To objDatabase.Replication.ReplicationDatabases.Count
    objDatabase.Databases.Refresh
    If VerifyDatabaseStatus(objDatabase.Databases(objDatabase.Replication.ReplicationDatabases(i).Name)) Then
        If objDatabase.Issysadmin Then
            count = count + objDatabase.Replication.ReplicationDatabases(i).MergePullSubscriptions.Count + _
                objDatabase.Replication.ReplicationDatabases(i).TransPullSubscriptions.Count
        End If                
    End If                 
Next

If objDatabase.VersionMajor >= 7 And objDatabase.VersionMinor >= 50 Then                            
    If objDatabase.Issysadmin Then
	   countPush = objDatabase.Replication.Subscriber.EnumAllSubscriptions().Rows                                        
    End If	    
End If                        

If count > 0 Then
    szSubscriberPull.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
Else
    szSubscriberPull.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
End If 

If countPush > 0 Then
    szSubscriberPush.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
Else        
    szSubscriberPush.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
End If
    



If objDatabase.isOS(1) = True Then
    szOS.innerText = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4147)
Else
    szOS.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4146) 
End If


If objDatabase.JobServer.type = 3 Then
    szMSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
Else
    szMSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
End If


If objDatabase.JobServer.type = 2 Then
    szTSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4144)
Else
    szTSX.innerText  = parent.window.objSQLNSContext.ProvideLocalizedString("sqlmmc.rll", 4145)
End If

End Sub
*/
</script>

      

</body>
</html>
